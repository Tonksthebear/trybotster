# Teardown commands to run when deleting a worktree
# These run before the worktree is deleted
# Available environment variables:
# - BOTSTER_REPO: Repository name (e.g., "owner/repo")
# - BOTSTER_ISSUE_NUMBER: Issue number
# - BOTSTER_WORKTREE_PATH: Path to the worktree being deleted
# - BOTSTER_BIN: Path to the botster binary

# Remove the worktree from Claude's trusted projects
"$BOTSTER_BIN" json-delete ~/.claude.json "projects.$BOTSTER_WORKTREE_PATH"

if [ "$BOTSTER_ISSUE_NUMBER" != "0" ]; then
  echo "Cleaned up worktree for issue #$BOTSTER_ISSUE_NUMBER"
else
  echo "Cleaned up worktree for branch: $BOTSTER_BRANCH_NAME"
fi
